<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.css"/>
    <script type="text/javascript"
            src="http://10.75.161.96:8080/jenkins/job/NeXt-Core/lastSuccessfulBuild/artifact/dest/next-core.js"></script>
    <script type="text/javascript"
            src="http://10.75.161.96:8080/jenkins/job/NeXt-UI/lastSuccessfulBuild/artifact/dest/js/next-ui.js"></script>
</head>
<body>
<svg id="viewport" style="width: 1000px;height:700px"></svg>
<script type="text/javascript">
    var viewport = document.getElementById('viewport');
    var svgNS = "http://www.w3.org/2000/svg";

    var X = nx.define({
        methods: {
            init: function () {

            }
        }
    });

    var Node = nx.define(X, {
        methods: {
            init: function () {
                this.inherited();
                var node = document.createElementNS(svgNS, 'g');
                node.setAttribute('transform', 'translate(' + Math.random() * 1000 + ', ' + Math.random() * 700 + ')')

                var text = document.createElementNS(svgNS, 'text');
                text.textContent = 'Hello world';
                text.setAttribute('fill', 'red');
                node.appendChild(text);

                var circle = document.createElementNS(svgNS, 'circle');
                circle.setAttribute('r', 5);
                circle.setAttribute('fill', '#aaa');
                circle.setAttribute('stroke', '#333');
                node.appendChild(circle);

                var group = document.createElementNS(svgNS, 'g');
                var g = document.createElementNS(svgNS, 'g');
                var t1 = document.createElementNS(svgNS, 'text');
                t1.textContent = 'This is a label';
                t1.setAttribute('fill', 'blue');
                var t2 = document.createElementNS(svgNS, 'text');
                t2.textContent = 'This is an icon';
                t2.setAttribute('fill', 'blue');
                g.appendChild(t1);
                g.appendChild(t2);
                group.appendChild(g);

                node.appendChild(group);

                viewport.appendChild(node);
            }
        }
    });

    var Link = nx.define({
        methods: {
            init: function () {
                var line = document.createElementNS(svgNS, 'line');
                line.setAttribute('x1', Math.random() * 1000);
                line.setAttribute('x2', Math.random() * 1000);
                line.setAttribute('y1', Math.random() * 700);
                line.setAttribute('y2', Math.random() * 700);
                line.setAttribute('stroke', '#666');
                viewport.appendChild(line);
            }
        }
    });


    (function () {
        var x = 10, y = 10;
        var start, end;

        start = new Date();
        for (var i = 0; i < 800; i++) {
            new Node();
//            new Link();
        }

        for (var j = 0; j < 1200; j++) {
//            new Node();
            new Link();
        }

        end = new Date();

        alert(end - start);

//        var dragTarget = null;
//        var positionX = 0;
//        var positionY = 0;
//
//        viewport.addEventListener('mousedown', function (e) {
//            dragTarget = e.target;
//            positionX = e.pageX;
//            positionY = e.pageY;
//        });
//
//        viewport.addEventListener('mouseup', function (e) {
//            dragTarget = null;
//        });
//
//        viewport.addEventListener('mousemove', function (e) {
//            if (dragTarget) {
//                var tx = e.pageX - positionX;
//                var ty = e.pageY - positionY;
//                dragTarget.style.webkitTransform = 'translate(' + tx + 'px,' + ty + 'px)';
//            }
//        });
    })();
</script>
</body>
</html>